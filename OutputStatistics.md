# Output Statistics
This document describes the output structures and descriptive statistics produced by this package. 

## pStack structures
These contain the image data (and meta-data) upon which we will work.
This structure is not altered during analysis.

pStack.imStack: The last plane or a 3D stack of planes. The stack we use if we are running tests with ground-truth data. 
                  In each case it should be one 2D matrix per physical section. Average optical planes if they are present. 
pStack.recipe: The acquisition recipe structure
pStack.voxelSizeInMicrons: Number of microns per pixel in x/y of pStack.imStack
pStack.tileSizeInMicrons: The size of a single tile. We assume tiles are square!
pStack.fullFOV: If true, the data are a full rectangular FOV. i.e. no non-imaged areas. NOTE: this is set as true by runOnStackStruct.
pStack.sectionNumber: The index of the section. e.g. if this was that 10th section this should equal 10.
            For ground-truth data, this is automatically filled in. 

pStack.nSamples: Optional. Not used at present
pStack.binarized: Only needed in ground-truth data. These borders indicate where sample tissue can be found.
pStack.borders: LEGACY NOT NEEDED


## autoROI
The output of autoROI is as follows:
stats.origPixelSize: Number of microns per pixel of pStack.imStack
stats.rescaledPixelSize: Number of microns per pixel used in analysis for ROI extraction
stats.nSamples: Number of samples copied from pStack. 
stats.settings: The settings used for the algorithm (see autoROI.readSettings)
stats.roiStats: A structure containing stats for each ROI (see below)

The roiStats structure contains data for each section:

roiStats.BoundingBoxes: A cell array of bounding boxes in the form: is [x y width height]. 
roiStats.tThresh: Absolute threshold used for computing the binary image
roiStats.tThreshSD: The number of SDs above the background pixel SD at which to set tThresh
roiStats.medianBackground: The median pixel value of the background pixels (those below tThresh).
roiStats.stdBackground: The standard deviation of the background pixels (those below tThresh).
roiStats.medianForeground: The median pixel value of the foreground (sample) pixels (those above tThresh).
roiStats.stdForeground: The standard deviation of the foreground (sample) pixels (those above tThresh).
roiStats.backgroundSqMM: Number of square mm of the backround pixels.
roiStats.foregroundSqMM: Number of square mm of the foreground pixels.
roiStats.BoundingBoxSqMM: Number of square mm of each bounding box in overall FOV
roiStats.meanBoundingBoxSqMM: The average size in sq mm of the bounding boxes
roiStats.totalBoundingBoxSqMM: Number of sq mm of all bounding boxes.
roiStats.propImagedAreaCoveredByBoundingBox: The proportion of the original FOV covered by bounding boxes. Only meaningful if pStack.fullFOV is true.
roiStats.tThreshSD_recalc: If true, the tThreshSD was recalculated at this section. This will be triggered by a large increase in laser power. 


## autoROI.test.runOnStackStruct
Running autoROI.test.runOnStackStruct produces the autoROI structure plus the following extra fields:

stats.numUnprocessedSections: The number of sections not processed by autoROI
stats.report: A summary data report generated by autoROI.test.evaluateBoundingBoxes (see below)
stats.autothreshStats: The stats generated by the initial run of autoROI.autothresh.run (see below)

The stats.report structure contains data produced by autoROI.test.evaluateBoundingBoxes, which is run at the conclusion of autoROI.test.runOnStackStruct

report.numSectionsWithHighCoverage: Number of sections where over 97.5% of the imaged area is covered by bounding boxes. Only meaningful if pStack.fullFOV is true.
report.numSectionsWithOverFlowingCoverage: Number of sections where over 100% of the imaged area is covered by bounding boxes. i.e. boxes over-flowed. Only meaningful if pStack.fullFOV is true.
report.medPropPixelsInRoiThatAreTissue: The median of roiStats.foregroundSqMM / totalBoundingBoxSqMM. This tells us what proportion of the ROI area actually contains tissue. This is judged as pixels above threshold *so the statistic is slightly cicrcular*. 
report.totalImagedSqMM: The total number of sq mm imaged in this sample
report.propImagedArea: The proportion of the full FOV that was imaged. Only meaningful if pStack.fullFOV is true.
report.txtReport: A text report that is easily human-readable.
report.nonImagedTiles: The non imaged area expressed in tiles for each section (a vector).
report.nonImagedSqMM: The non imaged area expressed in sq mm for each section (a vector).
report.extraSqMM: The number sq mm imaged more than once (for each section) due to overlapping ROIs. A vector.
report.nPlanesWithMissingTissue: The number of planes have any missing tissue at all.
